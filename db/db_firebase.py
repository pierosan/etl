import firebase_admin
from firebase_admin import credentials, firestore
from encriptado import desencriptar
import json

llave_privada_cifrada =  "83bcfe6c5bae0fdce558fde21b404ad59fa60cdad3e00219e485c958bd29f942613c837123caeb599b36775abd5b20154bf6604a78131419e74976a8819e7953c9c337922abcb181aacaa704b4a088fb2801660d1e66c7e39dd762705f1803ee0d3e407e6f362ca3342d5c7ff55b86674139a4884f7450b5a67247d21ab2adedf0a038cb20da13750ed52b299e77c786d58aac3749ba65742e7e212d7c15cd9a63c2c820ab79b8bfc62f4f037d88ef3a035204290f0a911ad02f600f8b23dfb26280270935e2f28f79f71609db2f8c6f7d1cb45993488bc2f307253c434ce3318cf118d7391c1b7c6ca4b3798fc370e1b34b3080a82f62f154870bb678f06e233a1654b8ed0c7e2c086ea01d0a10c358bb31ad0d13a21bc4a86b19d833287975f3dc75f556c488ffb065e1f10be163ab3ef14f7cbcdfccde22bd0422f49120d767903d711be7b0aaeaf50ee16fad9eeff61f3203d1664b17e40cfc730066a1b85e0796206c4aa1a18d1cb0a3e3c70773d11fe6308671654f25b0d1c9adc347ff0028e7cb92a60a205802bbcbeb37716b93a41661b892d6c28343f3729a5a303536876f85a3f00a9eb2e3e83d8c8781caa29eb7f0a7eaf33c91c04e01b3e05efff71e039516701aee17ba29e0c93fc82a5c3eb3e87241258d28f4edd6f4e65e6c8f6ac49da086f25e0ac30c610c813e6b4459e227f38d8149b2fb9f8d8f81fcd1473fa830445c534c5682fa86aa4120e2da328ae64e9b00268126e86b40d03239f3d1af95f5d3278d1ea80dafb89b82744c51221ae6eb3047d358d75c63edfcc392dea051ba69e4eb5174d2a01e10d3bb088508d841f485c6cf34789229c9c69a0ecd950b741e7e42ea5f948d88722e419176b38b118f7c140753444cc76b413de033c13420f400904ff2707a47bae05fe042669d0136990c6396c5b752de6c78b56f61968acdf96452d04f51dcfee23d243d14cfc363e346462b332a1d27b60a0d14b2c88beedb6f0d7029918591ecb3a76c8b0bd72d5889f6f6c6d7199186b8082ba7566f4edd694cd5834b76b42d9fcac42ccd8614438ba9654e84cb25982585c33c6356cad237eec6a1144e12a5216fd391d1965d398ecc9026b08fac9ac43550f4b7f92879ddb9583942fe39b854fdff20c475244b1cebe79e5583b85c720a8fd7784a4d56e3ba75e8939b9fe7e6530a4928a8b4e2a6f237c4695740e52dcf18aa93df6fbf94e8a3022069c004e46caceecccbddba05dc5a0f5ad2f5b31c8c617bd38c35c70ad50437cb4203ba8f2ebb91eb3ac44208e5a934b8901f5e02173964c829b8a39621a92c81a762a6aa70c7c04aa1d4bac585f1e3b16fb107c03e7087d3c8d92e43d359187cc252d442a144fe46e36876c2e22593a36a2bce311504717d594cf6915a31d983d3d29fa3f5fe05fc8c0a51526b1e0b815485cae8bed1514a6be27842f571060819c9728ba40a283b249a7e7b0d15f034bdefaf32745656eebc69186a8bef63e779c16ecfad986f558fb7ed5179c91769ce9f0aa0abaf792bccc767ccd2ed42427f32b85d1784e675adc8fb68fd48d32df7c6f3e36afde9625cb6dcf3fa81cc4803d7a1a3ed86c0656a67e605ddb9882f693db29473ac3c0f1d61a7f5d0862ad2e7680bd92dbc96926e8287e02f92b63b8e8533fda73df552bb93e289f8059c572e4b496e095fd294a78b53d9020b9f1a4675601424b2811c338d8a1bfb0f86f5a2a09e13f78e1d4f1a6fff3cac1d99bdae297aaf1e74ba6582ec6c4bccc7611abc670b72d898dcd692ca167f12a6e6ebc29a3422d333a79628ac795fd520cee92e82d7b7df0f8583700a6fce3f79821fdad89145fc203d30908e1436436abb32f068ef5b63e42bcede160caa95660648246683e750378361d4fa662b787e246849cc1117e74c0618147d128174bd7ca5c48105185877442e732dd0bc209b5c3e531b6d4a1744806268dee154eb61fe077bfcf4150616f095863b5538212bcce66eb179a05eec3867281b081265f028d19e271365ab83d36886095a6b64563415b719f2e89223c55c21debdec97ff97f8a5c8da6735418ef7ae104f360ffada9a670d7e403ebd5eac535ab9c407f0741ae0c645c131f05e06508cf25ff59f8896a24bfcd6fa29998053eaaea198788d811762a5eff6d5aecbd05d798fa7c65acc8c3adff22011438368fcb94453ee39bf1f5d67fc8f9f6a00e8edb888f8e917208d125725b13e704a4a07eecb41840e41c2aa594fdee1aec446ef0e8ce37ab9f635fb434bc0df0bd26256ff6bb0858b248fdb4846cf67506ce7a72ccbb9fcbd9a7696701cd05dfd27d8adf0731f51ef6c11c2e91dfd314ae0cdfa1dcb29b817955ecb31656c0f4551a2f984c7074a1ac223ff0f8b01b041336f00d31a69b62feb3dd8dc4373e38b25001df6fbfa0214e77702e73263dab8ffb38f229f495dc21b48a20b5c34c7b20e709c153944c49987e69113846ec40566ddbb2ad3366cd9a3c4d59673390a740be9cb44d7b0c4f57fd5c182c266fc16e563835126351bdeb16d4097c3e9948f474ff8c4708bc3f7a11ff3558b2ea8a3c7073ceea07de4f43ba86e3b12bb0b10f797dea203e86bd8292ba416f87c0bcdf737c783eeea9e985515a2fbc0b1645b435908582d2a6cc39f1d224a8985b3c92a68264596258fb81b9a16d6c41fad991c1fce36ecbbc354fa726fb53f510e312e58f9f6f2cc5425a1b99fb3ab467362d0268f62ad6b35d488ed1032a6ace76571112c44dd5cce3a61f0f8d11fc3a2cd8c44f2003e5462060218312b34b80d725bd7befb105e309e22a7759e8b2cc4aad02722a4344ae56ee36c5509f3c016f521c61575f34ce6e873d331b9163bd95a5d627a9183b8df2e2966eb34e157aaa10d78d35353658117b4ed423ebdbe39366d5178ec1bc5e6c4709f90ce5f1dfe3d6cfcd21f42d8b659fe8ebde3baae2b4467167d992927f772dc861725cde439af4a738eac10e522b7b9c1f1a5d6234bde432a644908219d4f836a6f94a522628f0fc0afe055c1a5cf0f2dab3c3ccf9c6e52d6ca4292fec70444c77350ab3fb7695c0d30fd17466c3548aba7d66febb0044c68cd50ea50dcf8f2bd30e5db1a13a858f900e2b93eab15208623ba21bd928f6f33b7e274c5c8ed7b51ec0beb573034c5650fc126e291d0501ec961a9e08d84a60cfe771f92a9a827f426492d521aa84ca4a4551f9846e444a3bd7a4a1d4af6433b6f9f62bca63f02f047c67c94d042d1fe2d54f95af7b76193900b4a91696bfe1662565e032d176ff1adf9dd5096a2d9162756597cdc28f62a2d89fe05c98645bf42f708e625b7fcd582031c98924079f68dc02540f2c24c326b6b"
def conexion():
    try:
        llave_privada_desifrada = desencriptar.descifrar_texto(llave_privada_cifrada)
        llave_privada_json = json.loads(llave_privada_desifrada)
        print("Iniciando conexion a Firebase Admin SDK")
        credenciales = credentials.Certificate(llave_privada_json)
        firebase_admin.initialize_app(credenciales)
        db = firestore.client()
        print("Firebase Admin SDK conectado")
        return db
    except Exception as e:
        print(f"Error al conectarse a Firebase Admin SDK: {e}")
        exit()
